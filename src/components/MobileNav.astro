---
// ResponsiveHeader.astro
import { navLinks, type NavLink } from "../data/nav";
import Image from "astro/components/Image.astro";
import logo from "../assets/images/logo.png";
---

<header
    class="fixed top-0 w-full z-50 bg-gradient-to-b from-purple/90 to-transparent py-4"
>
    <div class="container mx-auto flex justify-end items-center px-4">
        <!-- Desktop Nav -->
        <nav
            class="hidden md:flex items-center gap-6 backdrop-blur-md text-white rounded-full shadow-lg px-6 py-3 border border-white/20"
        >
            <!-- Logo -->
            <a
                href="/"
                class="flex items-center gap-2 hover:opacity-80 transition-opacity rounded-full overflow-hidden"
            >
                <Image
                    src={logo}
                    alt="Logo"
                    width="80"
                    height="80"
                    class="bg-white p-2"
                    loading="eager"
                />
            </a>
            <ul class="flex gap-4 flex-wrap items-center">
                {
                    navLinks.map((link: NavLink) => (
                        <li>
                            <a
                                href={link.href}
                                class="text-xl font-semibold capitalize px-3 py-1 rounded hover:bg-white/10 transition-colors"
                            >
                                {link.label}
                            </a>
                        </li>
                    ))
                }
            </ul>
        </nav>

        <!-- Hamburger Button -->
        <button
            id="hamburger"
            class="md:hidden flex relative ml-auto mr-2 flex-col gap-1 w-10 z-50 cursor-pointer"
            aria-label="Toggle menu"
        >
            <span
                id="bar1"
                class="w-full h-2 bg-purple rounded-sm border-white/50 border border-double transition-all"
            ></span>
            <span
                id="bar2"
                class="w-full h-2 bg-purple rounded-sm border-white/50 border border-double transition-all"
            ></span>
            <span
                id="bar3"
                class="w-full h-2 bg-purple rounded-sm border-white/50 border border-double transition-all"
            ></span>
        </button>
    </div>

    <!-- Mobile Menu -->
    <div
        id="mobile-menu"
        class="hidden md:hidden absolute top-full left-0 w-full bg-gradient-to-b from-purple via-purple/90 to-purple/80 backdrop-blur-md border-t border-white/20 shadow-2xl flex flex-col items-center gap-3 py-6 px-6 text-white animate-slide-down z-100"
    >
        {
            navLinks.map((link: NavLink) => (
                <a
                    href={link.href}
                    class="w-full text-center text-[1.1rem] font-semibold tracking-wide uppercase px-4 py-3 rounded-lg bg-white/5 hover:bg-white/15 hover:scale-[1.01] transition-all duration-200 ease-out shadow-sm"
                >
                    {link.label}
                </a>
            ))
        }
    </div>

    <!-- Toggle Script -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const hamburger = document.getElementById("hamburger");
            const menu = document.getElementById("mobile-menu");

            const bar1 = document.getElementById("bar1");
            const bar2 = document.getElementById("bar2");
            const bar3 = document.getElementById("bar3");

            let isOpen = false;

            // Toggle menu and animate hamburger
            hamburger?.addEventListener("click", () => {
                isOpen = !isOpen;
                menu?.classList.toggle("hidden");

                bar1?.classList.toggle("rotate-45");
                bar1?.classList.toggle("translate-y-3");

                bar2?.classList.toggle("opacity-0");

                bar3?.classList.toggle("-rotate-45");
                bar3?.classList.toggle("-translate-y-3");
            });

            // Reset on desktop resize
            const mediaQuery = window.matchMedia("(min-width: 768px)");
            mediaQuery.addEventListener("change", (e) => {
                if (e.matches) {
                    isOpen = false;
                    menu?.classList.add("hidden");

                    bar1?.classList.remove("rotate-45", "translate-y-3");
                    bar2?.classList.remove("opacity-0");
                    bar3?.classList.remove("-rotate-45", "-translate-y-3");
                }
            });
        });
    </script>
</header>
